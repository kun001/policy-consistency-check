## 项目概述

政策一致性检查系统旨在通过大语言模型技术，自动化分析地方政策与国家政策之间的一致性差异，为政策制定者提供科学、准确的决策支持。本文档详细阐述了系统设计的核心挑战、技术方案演进过程以及最终的落地实施方案。

## 核心难点
该项目的核心难点是怎样有效的通过大模型去分析差异点？
在实践中存在的核心难点主要有以下几个方面：
1.  怎样通过地方政策条款去从多个国家政策文件中检索出相关的条款？
2.  大模型不理解业务逻辑，即使找到了该如何分析？
3.  政策文件的格式多种多样，且有长有短，怎样合理的划分条款？
4.  时间和token上的损耗如何平衡？
5.  地方政策条款与国家条款的对应关系复杂，存在一对一、一对多，甚至地方完全新增的情况，多种情况该怎样合理处理。
   
## 方案设计
整体所需要设计的方面包括：
- 政策文件的分块、提取条款的方式。
- 工作流的流程设计。
- 大模型的提示词设计。
### 方案一：初期全量文档分析（概念验证阶段）
#### 技术架构
```
输入层：地方政策条款 + 完整国家政策文档集
   ↓
处理层：大语言模型直接分析
   ↓
输出层：结构化差异分析结果
```
#### 核心特点
- **分块策略**：基于规则的条款提取，采用正则表达式解析标准格式文档
- **工作流程**：简化的三节点流程（输入 → LLM分析 → 输出）
- **模型输入**：
  - 待分析地方政策条款
  - 完整地方政策文档上下文
  - 全量国家政策文档集合
#### 提示词框架
```markdown
## 角色定义
政策分析专家，具备深度的法规解读能力

## 分析任务
对比分析地方政策条款与国家政策的一致性

## 差异分类体系
- 缺失：地方政策未涵盖的国家要求
- 冲突：地方政策与国家政策直接矛盾
- 细化：地方政策对国家政策的具体化实施
- 超越：地方政策超出国家策授权范围

## 输出规范
标准JSON格式，包含差异类型、具体内容、影响评估
```

#### 方案效果
该方案的效果挺好，不用担心上下文不足的情况，但是在token上的消耗非常大，实际中使用qwen3-max模型，分析一个包含125条条款的文件，需要花费50元上下，成本难以接受。
### 方案二：RAG优化方案（开源方案）
#### 技术架构
```
输入层：地方政策条款
   ↓
检索层：向量数据库相似性搜索（Top-K）
   ↓
处理层：大语言模型分析（精简输入）
   ↓
输出层：结构化差异分析结果
```

#### 核心改进
- **智能检索**：引入RAG（检索增强生成）技术，显著减少输入Token数量
- **工作流程**：四节点流程（输入 → 向量检索 → LLM分析 → 输出）
- **优化输入**：
  - 待分析地方政策条款
  - 地方政策文档上下文
  - Top-15相似国家政策条款（而非全文档）

#### 性能评估
- **分析质量**：良好，保持较高准确度
- **成本控制**：显著改善，125条条款分析成本降至约15元
- **处理效率**：略有下降，增加1-2秒检索时间
- **适用场景**：中等规模应用，成本敏感场景

### 方案三：生产级优化方案（商业级）

#### 技术架构升级
```
文档预处理层：多粒度分块 + 格式标准化
   ↓
向量存储层：多层级嵌入索引（章/节/条）
   ↓
智能检索层：上下文感知的相似性搜索
   ↓
分析引擎层：领域知识增强的LLM分析
   ↓
结果输出层：结构化差异报告
```

#### 核心技术创新

##### 1. 多粒度分块策略
同时使用章级、节级、条级分块，以保持政策主题的完整性，平衡上下文与检索精度，精确定位具体条款内容。
- **章级分块**：保持政策主题的完整性
- **节级分块**：平衡上下文与检索精度
- **条级分块**：精确定位具体条款内容
- **嵌入模型**：Qwen-Embedding（4096维），支持长文本处理

##### 2. 领域知识增强
**业务背景集成**：
- 行业政策规则专业知识
- 政策制定层级关系理解
- 领域特定术语和概念映射

#### 提示词工程优化
```markdown
## 专家角色
资深政策分析师，精通行业政策法规

## 领域背景
添加行业领域背景知识

## 分析框架
1. 政策条款语义理解
2. 层级关系合规性检查
3. 实施细则合理性评估
4. 创新性条款风险评估

## 差异分类标准
[详细的分类判断标准，包含具体示例]

## 输出规范
结构化JSON格式
```

#### 性能指标
- **分析准确率**：>90%（基于人工标注数据集验证）
- **成本效率**：125条条款对比分析成本约15元
- **系统稳定性**：支持并发处理，4路并发125条条款文件<20分钟

## 技术方案对比分析

| 维度 | 方案一 | 方案二| 方案三|
|------|------------------|------------------|-----------------|
| **分析准确度** | 95% | 88% | 92% |
| **Token成本** | 50元/125条 | 15元/125条 | 15元/125条 |
| **处理时间** | 60分 | 60分 | 20分 |
| **系统复杂度** | 低 | 中 | 高 |
| **可扩展性** | 差 | 中 | 优 |
| **维护成本** | 低 | 中 | 中 |

## 其它：失败方案设计
（1）仅输入待对比的一条地方条款，通过RAG检索相似的地方条款与国家条款，再做对比。成本会更低，但RAG检索难度高，会常常出现上下文不足的情况，导致大模型误判。
（2）使用deepseek r1 思考类的模型，效果与qwen3-max基本相同，但是生成时间显著拉长，难以适用。
（3）精细化提示词，早期在使用RAG方案时，把提示词的分类标准写的极其详细，接近1w字，基准测试文件效果不错，但泛化性太差，难以拓展使用。